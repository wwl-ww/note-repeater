# 音符中继器 (Note Repeater)

- [音符中继器 (Note Repeater)](#音符中继器-note-repeater)
  - [物品配方](#物品配方)
  - [功能速览](#功能速览)
  - [使用说明](#使用说明)
  - [扩充指令](#扩充指令)
  - [注意事项](#注意事项)
  - [讨论](#讨论)


一个基于红石中继器的音乐节奏控制器，可以精确控制音符盒的播放节奏。

## 物品配方

![recipe](assets\recipe.png "recipe")

## 功能速览
![diagram](assets\diagram.png "diagram")

左图：四种挡位
中间：四种挡位(激活)
右边：锁存功能(虽然没有基岩条)


## 使用说明
1. 使用右键可以调整延迟等级（1-4）

2. 延迟等级对应的分频：
   - 1档 = 四分音符（1/4）
   - 2档 = 八分音符（1/8）
   - 3档 = 十六分音符（1/16）
   - 4档 = 三十二分音符（1/32）

3. 锁定功能

## 扩充指令

1. 设置BPM
```
/setbpm <数值>
```
需要OP权限；只能使用预设的(见下一章节的表格)BPM值；如果输入的不是预设值，会自动选择最接近的值

2. 查看当前BPM
```
/getbpm
```
所有玩家都可以使用；显示当前的BPM设置 

## 注意事项

1. BPM与Tick的对应关系（X表示无法整除，将向上取整）：

由于游戏的时间基本单位为tick，所以建立不以tick为基础的框架工程量巨大。

所以我们不得不提供一个表格，来说明在**每种bpm下，每种音符对应的tick数**。
其中**X**表示在该bpm下该音符不是tick的整数倍，代表该音符不再可用。

实际情况中，音乐制作者可以先选择比目标速度稍慢的速度，再通过剪辑倍速进行调节。

| BPM | 四分音符 | 八分音符 | 十六分音符 | 三十二分音符 |
|-----|---------|----------|------------|-------------|
| 40  | 30      | 15       | X          | X           |
| 50  | 24      | 12       | 6          | 3           |
| 60  | 20      | 10       | 5          | X           |
| 75  | 16      | 8        | 4          | 2           |
| 100 | 12      | 6        | 3          | X           |
| 120 | 10      | 5        | X          | X           |
| 150 | 8       | 4        | 2          | 1           |
| 200 | 6       | 3        | X          | X           |
| 240 | 5       | X        | X          | X           |
| 300 | 4       | 2        | 1          | X           |
| 600 | 2       | 1        | X          | X           |
| 1200| 1       | X        | X          | X           |


2. 变速

在实际使用中，可以连接命令方块(在命令方块中设置bpm)达到临时变速的效果。

## 讨论
我们真心希望能有团队做出不基于tick的框架，实现任意bpm的控制！！！